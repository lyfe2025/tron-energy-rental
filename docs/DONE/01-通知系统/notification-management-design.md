# TRONèƒ½é‡ç§Ÿèµé¡¹ç›®é€šçŸ¥ç®¡ç†ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®é€šçŸ¥ç±»å‹å®Œæ•´æ¸…å•

### ğŸ”¥ ä¸šåŠ¡æ ¸å¿ƒé€šçŸ¥ï¼ˆè‡ªåŠ¨è§¦å‘ï¼‰

| é€šçŸ¥ç±»å‹ | è§¦å‘æ—¶æœº | ç›®æ ‡ç”¨æˆ· | ä¼˜å…ˆçº§ | æ˜¯å¦å¯é…ç½® |
|----------|----------|----------|--------|-----------|
| **è®¢å•åˆ›å»ºé€šçŸ¥** | ç”¨æˆ·ä¸‹å•æˆåŠŸ | è®¢å•ç”¨æˆ· | ğŸ”¥ é«˜ | âœ… |
| **æ”¯ä»˜æˆåŠŸé€šçŸ¥** | æ£€æµ‹åˆ°æ”¯ä»˜åˆ°è´¦ | è®¢å•ç”¨æˆ· | ğŸ”¥ é«˜ | âœ… |
| **æ”¯ä»˜è¶…æ—¶é€šçŸ¥** | è®¢å•15åˆ†é’Ÿæœªæ”¯ä»˜ | è®¢å•ç”¨æˆ· | ğŸ”¥ é«˜ | âœ… |
| **èƒ½é‡å§”æ‰˜æˆåŠŸé€šçŸ¥** | èƒ½é‡å§”æ‰˜å®Œæˆ | è®¢å•ç”¨æˆ· | ğŸ”¥ é«˜ | âœ… |
| **èƒ½é‡å§”æ‰˜å¤±è´¥é€šçŸ¥** | å§”æ‰˜è¿‡ç¨‹å¤±è´¥ | è®¢å•ç”¨æˆ· | ğŸ”¥ é«˜ | âœ… |
| **è®¢å•çŠ¶æ€å˜æ›´é€šçŸ¥** | å¤„ç†ä¸­ã€å·²å®Œæˆã€å¤±è´¥ | è®¢å•ç”¨æˆ· | ğŸ”¥ é«˜ | âœ… |
| **ä½™é¢å……å€¼æˆåŠŸé€šçŸ¥** | ç”¨æˆ·å……å€¼åˆ°è´¦ | å……å€¼ç”¨æˆ· | ğŸ”¥ é«˜ | âœ… |
| **ä½™é¢ä¸è¶³æé†’** | ä¸‹å•æ—¶ä½™é¢ä¸è¶³ | è®¢å•ç”¨æˆ· | ğŸ”„ ä¸­ | âœ… |

### ğŸ’° ä»£ç†ä¸šåŠ¡é€šçŸ¥ï¼ˆè‡ªåŠ¨è§¦å‘ï¼‰

| é€šçŸ¥ç±»å‹ | è§¦å‘æ—¶æœº | ç›®æ ‡ç”¨æˆ· | ä¼˜å…ˆçº§ | æ˜¯å¦å¯é…ç½® |
|----------|----------|----------|--------|-----------|
| **ä»£ç†ç”³è¯·æäº¤é€šçŸ¥** | ç”¨æˆ·æäº¤ä»£ç†ç”³è¯· | ç”³è¯·ç”¨æˆ· | ğŸ”„ ä¸­ | âœ… |
| **ä»£ç†å®¡æ ¸é€šè¿‡é€šçŸ¥** | ç®¡ç†å‘˜å®¡æ ¸é€šè¿‡ | ä»£ç†ç”¨æˆ· | ğŸ”¥ é«˜ | âœ… |
| **ä»£ç†å®¡æ ¸æ‹’ç»é€šçŸ¥** | ç®¡ç†å‘˜å®¡æ ¸æ‹’ç» | ç”³è¯·ç”¨æˆ· | ğŸ”„ ä¸­ | âœ… |
| **ä½£é‡‘åˆ°è´¦é€šçŸ¥** | ä¸‹çº§ç”¨æˆ·æ¶ˆè´¹äº§ç”Ÿä½£é‡‘ | ä»£ç†ç”¨æˆ· | ğŸ”„ ä¸­ | âœ… |
| **ä»£ç†ç­‰çº§å‡çº§é€šçŸ¥** | è¾¾åˆ°å‡çº§æ¡ä»¶ | ä»£ç†ç”¨æˆ· | â­ ä½ | âœ… |
| **æç°æˆåŠŸé€šçŸ¥** | ä½£é‡‘æç°å®Œæˆ | ä»£ç†ç”¨æˆ· | ğŸ”¥ é«˜ | âœ… |
| **æœˆåº¦ä½£é‡‘ç»Ÿè®¡é€šçŸ¥** | æ¯æœˆ1å·å‘é€ | æ‰€æœ‰ä»£ç† | â­ ä½ | âœ… |

### ğŸ’° ä»·æ ¼å’Œå¸‚åœºé€šçŸ¥ï¼ˆè‡ªåŠ¨è§¦å‘ï¼‰

| é€šçŸ¥ç±»å‹ | è§¦å‘æ—¶æœº | ç›®æ ‡ç”¨æˆ· | ä¼˜å…ˆçº§ | æ˜¯å¦å¯é…ç½® |
|----------|----------|----------|--------|-----------|
| **ä»·æ ¼ä¸Šæ¶¨é€šçŸ¥** | èƒ½é‡ä»·æ ¼ä¸Šæ¶¨5%ä»¥ä¸Š | è®¢é˜…ç”¨æˆ· | ğŸ”„ ä¸­ | âœ… |
| **ä»·æ ¼ä¸‹é™é€šçŸ¥** | èƒ½é‡ä»·æ ¼ä¸‹é™5%ä»¥ä¸Š | è®¢é˜…ç”¨æˆ· | ğŸ”„ ä¸­ | âœ… |
| **æ–°å¥—é¤ä¸Šçº¿é€šçŸ¥** | æ–°å¢èƒ½é‡å¥—é¤ | æ‰€æœ‰ç”¨æˆ· | â­ ä½ | âœ… |
| **é™æ—¶ä¼˜æƒ é€šçŸ¥** | ç‰¹ä»·æ´»åŠ¨å¼€å§‹ | ç›®æ ‡ç¾¤ä½“ | ğŸ”„ ä¸­ | âœ… |
| **åº“å­˜é¢„è­¦é€šçŸ¥** | èƒ½é‡æ± åº“å­˜ä¸è¶³ | ç®¡ç†å‘˜ | âš ï¸ é«˜ | âœ… |

### âš ï¸ ç³»ç»Ÿå’Œå®‰å…¨é€šçŸ¥ï¼ˆç®¡ç†å‘˜æ‰‹åŠ¨/è‡ªåŠ¨è§¦å‘ï¼‰

| é€šçŸ¥ç±»å‹ | è§¦å‘æ—¶æœº | ç›®æ ‡ç”¨æˆ· | ä¼˜å…ˆçº§ | è§¦å‘æ–¹å¼ |
|----------|----------|----------|--------|----------|
| **ç³»ç»Ÿç»´æŠ¤é€šçŸ¥** | è®¡åˆ’ç»´æŠ¤å‰24å°æ—¶ | æ‰€æœ‰ç”¨æˆ· | âš ï¸ é«˜ | ğŸ”§ ç®¡ç†å‘˜æ‰‹åŠ¨ |
| **ç»´æŠ¤å¼€å§‹é€šçŸ¥** | ç»´æŠ¤å¼€å§‹æ—¶ | æ‰€æœ‰ç”¨æˆ· | âš ï¸ é«˜ | ğŸ”§ ç®¡ç†å‘˜æ‰‹åŠ¨ |
| **ç»´æŠ¤å®Œæˆé€šçŸ¥** | ç»´æŠ¤ç»“æŸå | æ‰€æœ‰ç”¨æˆ· | âš ï¸ é«˜ | ğŸ”§ ç®¡ç†å‘˜æ‰‹åŠ¨ |
| **ç³»ç»Ÿå¼‚å¸¸é€šçŸ¥** | å…³é”®æœåŠ¡æ•…éšœ | ç®¡ç†å‘˜ | ğŸš¨ ç´§æ€¥ | ğŸ¤– è‡ªåŠ¨è§¦å‘ |
| **å®‰å…¨è­¦å‘Šé€šçŸ¥** | å¼‚å¸¸ç™»å½•ã€å¤§é¢äº¤æ˜“ | ç›¸å…³ç”¨æˆ· | âš ï¸ é«˜ | ğŸ¤– è‡ªåŠ¨è§¦å‘ |
| **æ¯æ—¥æ•°æ®æŠ¥å‘Š** | æ¯æ—¥23:59 | ç®¡ç†å‘˜ | â­ ä½ | ğŸ¤– è‡ªåŠ¨è§¦å‘ |
| **é‡è¦å…¬å‘Šé€šçŸ¥** | æ”¿ç­–å˜æ›´ã€é‡è¦å£°æ˜ | æ‰€æœ‰ç”¨æˆ· | âš ï¸ é«˜ | ğŸ”§ ç®¡ç†å‘˜æ‰‹åŠ¨ |
| **èŠ‚å‡æ—¥ç¥ç¦** | èŠ‚å‡æ—¥å½“å¤© | æ‰€æœ‰ç”¨æˆ· | â­ ä½ | ğŸ”§ ç®¡ç†å‘˜æ‰‹åŠ¨ |

### ğŸ“Š è¿è¥å’Œè¥é”€é€šçŸ¥ï¼ˆç®¡ç†å‘˜æ‰‹åŠ¨è§¦å‘ï¼‰

| é€šçŸ¥ç±»å‹ | è§¦å‘æ—¶æœº | ç›®æ ‡ç”¨æˆ· | ä¼˜å…ˆçº§ | ç‰¹æ®Šè¯´æ˜ |
|----------|----------|----------|--------|----------|
| **ç”¨æˆ·ç”Ÿæ—¥ç¥ç¦** | ç”¨æˆ·ç”Ÿæ—¥å½“å¤© | ç”Ÿæ—¥ç”¨æˆ· | â­ ä½ | å¯è®¾ç½®è‡ªåŠ¨/æ‰‹åŠ¨ |
| **é•¿æœŸæœªä½¿ç”¨æé†’** | 30å¤©æœªç™»å½• | æ²‰ç¡ç”¨æˆ· | â­ ä½ | è‡ªåŠ¨æ‰¹é‡å‘é€ |
| **æ–°åŠŸèƒ½ä»‹ç»** | åŠŸèƒ½ä¸Šçº¿æ—¶ | ç›®æ ‡ç”¨æˆ·ç¾¤ | ğŸ”„ ä¸­ | åˆ†æ‰¹æ¬¡å‘é€ |
| **ç”¨æˆ·æ»¡æ„åº¦è°ƒæŸ¥** | æ¯å­£åº¦ä¸€æ¬¡ | æ´»è·ƒç”¨æˆ· | â­ ä½ | é—®å·å½¢å¼ |
| **VIPç”¨æˆ·ä¸“äº«é€šçŸ¥** | ç‰¹æ®Šæ´»åŠ¨ | VIPç”¨æˆ· | ğŸ”„ ä¸­ | ä¸ªæ€§åŒ–å†…å®¹ |

## ğŸ›ï¸ æœºå™¨äººå¡ç‰‡é€šçŸ¥é…ç½®ç•Œé¢è®¾è®¡

### ä¸»ç•Œé¢å¸ƒå±€

```typescript
// æœºå™¨äººå¡ç‰‡æ‰©å±• - é€šçŸ¥ç®¡ç†æ ‡ç­¾é¡µ
interface BotNotificationConfig {
  // åŸºç¡€è®¾ç½®
  enabled: boolean;                    // é€šçŸ¥åŠŸèƒ½æ€»å¼€å…³
  default_language: string;            // é»˜è®¤è¯­è¨€
  timezone: string;                   // æ—¶åŒºè®¾ç½®
  
  // é€šçŸ¥åˆ†ç±»é…ç½®
  business_notifications: BusinessNotificationConfig;    // ä¸šåŠ¡é€šçŸ¥
  agent_notifications: AgentNotificationConfig;         // ä»£ç†é€šçŸ¥
  price_notifications: PriceNotificationConfig;        // ä»·æ ¼é€šçŸ¥
  system_notifications: SystemNotificationConfig;      // ç³»ç»Ÿé€šçŸ¥
  marketing_notifications: MarketingNotificationConfig; // è¥é”€é€šçŸ¥
  
  // å‘é€ç­–ç•¥
  rate_limiting: RateLimitingConfig;   // é¢‘ç‡é™åˆ¶
  retry_strategy: RetryConfig;         // é‡è¯•ç­–ç•¥
  quiet_hours: QuietHoursConfig;       // é™é»˜æ—¶é—´
  
  // æ¨¡æ¿ç®¡ç†
  message_templates: MessageTemplateConfig;  // æ¶ˆæ¯æ¨¡æ¿
  
  // ç»Ÿè®¡å’Œç›‘æ§
  analytics_enabled: boolean;          // ç»Ÿè®¡å¼€å…³
  performance_monitoring: boolean;     // æ€§èƒ½ç›‘æ§
}
```

### é€šçŸ¥é…ç½®ç•Œé¢ç»„ä»¶

```vue
<template>
  <div class="bot-notification-management">
    <!-- é€šçŸ¥åŠŸèƒ½æ€»å¼€å…³ -->
    <div class="notification-master-switch">
      <el-switch 
        v-model="config.enabled"
        active-text="é€šçŸ¥åŠŸèƒ½å·²å¯ç”¨"
        inactive-text="é€šçŸ¥åŠŸèƒ½å·²ç¦ç”¨"
        size="large"
      />
    </div>

    <!-- é€šçŸ¥åˆ†ç±»é…ç½®æ ‡ç­¾é¡µ -->
    <el-tabs v-model="activeTab" type="border-card">
      
      <!-- ä¸šåŠ¡é€šçŸ¥é…ç½® -->
      <el-tab-pane label="ğŸ’¼ ä¸šåŠ¡é€šçŸ¥" name="business">
        <BusinessNotificationPanel 
          v-model="config.business_notifications"
          :bot-id="botId"
        />
      </el-tab-pane>

      <!-- ä»£ç†é€šçŸ¥é…ç½® -->
      <el-tab-pane label="ğŸ‘¥ ä»£ç†é€šçŸ¥" name="agent">
        <AgentNotificationPanel 
          v-model="config.agent_notifications"
          :bot-id="botId"
        />
      </el-tab-pane>

      <!-- ä»·æ ¼é€šçŸ¥é…ç½® -->
      <el-tab-pane label="ğŸ’° ä»·æ ¼é€šçŸ¥" name="price">
        <PriceNotificationPanel 
          v-model="config.price_notifications"
          :bot-id="botId"
        />
      </el-tab-pane>

      <!-- ç³»ç»Ÿé€šçŸ¥é…ç½® -->
      <el-tab-pane label="âš ï¸ ç³»ç»Ÿé€šçŸ¥" name="system">
        <SystemNotificationPanel 
          v-model="config.system_notifications"
          :bot-id="botId"
        />
      </el-tab-pane>

      <!-- è¥é”€é€šçŸ¥é…ç½® -->
      <el-tab-pane label="ğŸ“¢ è¥é”€é€šçŸ¥" name="marketing">
        <MarketingNotificationPanel 
          v-model="config.marketing_notifications"
          :bot-id="botId"
        />
      </el-tab-pane>

      <!-- æ¶ˆæ¯æ¨¡æ¿ç®¡ç† -->
      <el-tab-pane label="ğŸ“ æ¶ˆæ¯æ¨¡æ¿" name="templates">
        <MessageTemplatePanel 
          v-model="config.message_templates"
          :bot-id="botId"
        />
      </el-tab-pane>

      <!-- å‘é€è®¾ç½® -->
      <el-tab-pane label="âš™ï¸ å‘é€è®¾ç½®" name="settings">
        <NotificationSettingsPanel 
          v-model="config"
          :bot-id="botId"
        />
      </el-tab-pane>

      <!-- ç»Ÿè®¡ç›‘æ§ -->
      <el-tab-pane label="ğŸ“Š ç»Ÿè®¡ç›‘æ§" name="analytics">
        <NotificationAnalyticsPanel 
          :bot-id="botId"
        />
      </el-tab-pane>

    </el-tabs>

    <!-- å¿«é€Ÿæ“ä½œåŒºåŸŸ -->
    <div class="quick-actions">
      <el-button 
        type="primary" 
        :icon="Send"
        @click="showManualNotificationDialog = true"
      >
        ğŸ“¢ å‘é€ç³»ç»Ÿé€šçŸ¥
      </el-button>
      
      <el-button 
        type="success"
        :icon="DocumentCopy"
        @click="exportConfig"
      >
        ğŸ“„ å¯¼å‡ºé…ç½®
      </el-button>
      
      <el-button 
        type="warning"
        :icon="Upload"
        @click="importConfig"
      >
        ğŸ“‚ å¯¼å…¥é…ç½®
      </el-button>
    </div>

    <!-- æ‰‹åŠ¨å‘é€é€šçŸ¥å¯¹è¯æ¡† -->
    <ManualNotificationDialog 
      v-model="showManualNotificationDialog"
      :bot-id="botId"
      @sent="handleNotificationSent"
    />

  </div>
</template>
```

### ä¸šåŠ¡é€šçŸ¥é…ç½®é¢æ¿

```vue
<template>
  <div class="business-notification-panel">
    <el-card>
      <template #header>
        <span>ğŸ’¼ ä¸šåŠ¡é€šçŸ¥é…ç½®</span>
        <el-switch 
          v-model="config.enabled"
          class="float-right"
        />
      </template>

      <!-- è®¢å•ç›¸å…³é€šçŸ¥ -->
      <el-collapse v-model="activeNames">
        
        <el-collapse-item title="ğŸ“‹ è®¢å•é€šçŸ¥" name="order">
          <div class="notification-group">
            
            <div class="notification-item">
              <div class="item-header">
                <span>è®¢å•åˆ›å»ºé€šçŸ¥</span>
                <el-switch v-model="config.order_created.enabled" />
              </div>
              <div class="item-content" v-if="config.order_created.enabled">
                <el-form-item label="å‘é€å»¶è¿Ÿ">
                  <el-input-number 
                    v-model="config.order_created.delay_seconds"
                    :min="0" :max="300" 
                    controls-position="right"
                  />
                  <span class="unit">ç§’</span>
                </el-form-item>
                
                <el-form-item label="åŒ…å«å†…å®¹">
                  <el-checkbox-group v-model="config.order_created.include_fields">
                    <el-checkbox label="order_id">è®¢å•å·</el-checkbox>
                    <el-checkbox label="package_name">å¥—é¤åç§°</el-checkbox>
                    <el-checkbox label="amount">é‡‘é¢</el-checkbox>
                    <el-checkbox label="target_address">ç›®æ ‡åœ°å€</el-checkbox>
                    <el-checkbox label="payment_qr">æ”¯ä»˜äºŒç»´ç </el-checkbox>
                  </el-checkbox-group>
                </el-form-item>

                <el-form-item label="æ“ä½œæŒ‰é’®">
                  <el-checkbox-group v-model="config.order_created.action_buttons">
                    <el-checkbox label="view_details">æŸ¥çœ‹è¯¦æƒ…</el-checkbox>
                    <el-checkbox label="contact_support">è”ç³»å®¢æœ</el-checkbox>
                    <el-checkbox label="cancel_order">å–æ¶ˆè®¢å•</el-checkbox>
                  </el-checkbox-group>
                </el-form-item>
              </div>
            </div>

            <el-divider />

            <div class="notification-item">
              <div class="item-header">
                <span>æ”¯ä»˜æˆåŠŸé€šçŸ¥</span>
                <el-switch v-model="config.payment_success.enabled" />
              </div>
              <div class="item-content" v-if="config.payment_success.enabled">
                <el-form-item label="åŒ…å«å›¾ç‰‡">
                  <el-switch v-model="config.payment_success.include_image" />
                </el-form-item>
                
                <el-form-item label="æ˜¾ç¤ºäº¤æ˜“é“¾æ¥">
                  <el-switch v-model="config.payment_success.show_tx_link" />
                </el-form-item>

                <el-form-item label="åç»­æ“ä½œæç¤º">
                  <el-checkbox-group v-model="config.payment_success.next_actions">
                    <el-checkbox label="show_processing_time">æ˜¾ç¤ºå¤„ç†æ—¶é—´</el-checkbox>
                    <el-checkbox label="show_delegation_status">æ˜¾ç¤ºå§”æ‰˜çŠ¶æ€</el-checkbox>
                    <el-checkbox label="offer_more_packages">æ¨èå…¶ä»–å¥—é¤</el-checkbox>
                  </el-checkbox-group>
                </el-form-item>
              </div>
            </div>

            <!-- å…¶ä»–è®¢å•é€šçŸ¥é…ç½®é¡¹... -->
            
          </div>
        </el-collapse-item>

        <!-- èƒ½é‡å§”æ‰˜é€šçŸ¥ -->
        <el-collapse-item title="âš¡ èƒ½é‡å§”æ‰˜é€šçŸ¥" name="delegation">
          <!-- ç±»ä¼¼çš„é…ç½®ç»“æ„ -->
        </el-collapse-item>

      </el-collapse>
    </el-card>
  </div>
</template>
```

### ç³»ç»Ÿé€šçŸ¥ç®¡ç†é¢æ¿ï¼ˆç®¡ç†å‘˜æ‰‹åŠ¨è§¦å‘ï¼‰

```vue
<template>
  <div class="system-notification-panel">
    
    <!-- ç³»ç»Ÿç»´æŠ¤é€šçŸ¥ -->
    <el-card class="maintenance-notification">
      <template #header>
        <span>ğŸ”§ ç³»ç»Ÿç»´æŠ¤é€šçŸ¥</span>
      </template>

      <el-form :model="maintenanceForm" label-width="120px">
        
        <el-form-item label="ç»´æŠ¤ç±»å‹">
          <el-select v-model="maintenanceForm.type" placeholder="é€‰æ‹©ç»´æŠ¤ç±»å‹">
            <el-option label="è®¡åˆ’ç»´æŠ¤" value="scheduled" />
            <el-option label="ç´§æ€¥ç»´æŠ¤" value="emergency" />
            <el-option label="åŠŸèƒ½å‡çº§" value="upgrade" />
          </el-select>
        </el-form-item>

        <el-form-item label="å¼€å§‹æ—¶é—´">
          <el-date-picker
            v-model="maintenanceForm.start_time"
            type="datetime"
            placeholder="é€‰æ‹©å¼€å§‹æ—¶é—´"
          />
        </el-form-item>

        <el-form-item label="é¢„è®¡æ—¶é•¿">
          <el-input-number 
            v-model="maintenanceForm.duration_hours"
            :min="0.5" :max="24" :step="0.5"
            controls-position="right"
          />
          <span class="unit">å°æ—¶</span>
        </el-form-item>

        <el-form-item label="å½±å“åŠŸèƒ½">
          <el-checkbox-group v-model="maintenanceForm.affected_features">
            <el-checkbox label="order_creation">ä¸‹å•åŠŸèƒ½</el-checkbox>
            <el-checkbox label="payment_processing">æ”¯ä»˜å¤„ç†</el-checkbox>
            <el-checkbox label="energy_delegation">èƒ½é‡å§”æ‰˜</el-checkbox>
            <el-checkbox label="agent_functions">ä»£ç†åŠŸèƒ½</el-checkbox>
            <el-checkbox label="customer_service">å®¢æœæ”¯æŒ</el-checkbox>
          </el-checkbox-group>
        </el-form-item>

        <el-form-item label="ç»´æŠ¤å†…å®¹">
          <el-input 
            type="textarea" 
            v-model="maintenanceForm.description"
            placeholder="è¯¦ç»†æè¿°æœ¬æ¬¡ç»´æŠ¤çš„å†…å®¹å’Œç›®çš„"
            :rows="3"
          />
        </el-form-item>

        <el-form-item label="å‘é€æ—¶æœº">
          <el-checkbox-group v-model="maintenanceForm.send_schedule">
            <el-checkbox label="advance_24h">æå‰24å°æ—¶é€šçŸ¥</el-checkbox>
            <el-checkbox label="advance_1h">æå‰1å°æ—¶æé†’</el-checkbox>
            <el-checkbox label="start_notification">ç»´æŠ¤å¼€å§‹é€šçŸ¥</el-checkbox>
            <el-checkbox label="completion_notification">ç»´æŠ¤å®Œæˆé€šçŸ¥</el-checkbox>
          </el-checkbox-group>
        </el-form-item>

        <el-form-item label="ç›®æ ‡ç”¨æˆ·">
          <el-radio-group v-model="maintenanceForm.target_users">
            <el-radio label="all">æ‰€æœ‰ç”¨æˆ·</el-radio>
            <el-radio label="active_only">ä»…æ´»è·ƒç”¨æˆ·</el-radio>
            <el-radio label="agents_only">ä»…ä»£ç†ç”¨æˆ·</el-radio>
            <el-radio label="custom">è‡ªå®šä¹‰ç¾¤ä½“</el-radio>
          </el-radio-group>
        </el-form-item>

        <el-form-item>
          <el-button 
            type="primary" 
            @click="scheduleMaintenanceNotification"
            :loading="sendingMaintenance"
          >
            ğŸ“… å®‰æ’ç»´æŠ¤é€šçŸ¥
          </el-button>
          
          <el-button 
            type="warning" 
            @click="sendImmediateNotification"
            :loading="sendingImmediate"
          >
            ğŸ“¢ ç«‹å³å‘é€é€šçŸ¥
          </el-button>
        </el-form-item>

      </el-form>
    </el-card>

    <!-- é‡è¦å…¬å‘Šé€šçŸ¥ -->
    <el-card class="announcement-notification">
      <template #header>
        <span>ğŸ“¢ é‡è¦å…¬å‘Š</span>
      </template>

      <el-form :model="announcementForm" label-width="120px">
        
        <el-form-item label="å…¬å‘Šç±»å‹">
          <el-select v-model="announcementForm.type" placeholder="é€‰æ‹©å…¬å‘Šç±»å‹">
            <el-option label="æ”¿ç­–å˜æ›´" value="policy_change" />
            <el-option label="åŠŸèƒ½æ›´æ–°" value="feature_update" />
            <el-option label="å®‰å…¨æé†’" value="security_alert" />
            <el-option label="èŠ‚å‡æ—¥ç¥ç¦" value="holiday_greeting" />
            <el-option label="å…¶ä»–å…¬å‘Š" value="general" />
          </el-select>
        </el-form-item>

        <el-form-item label="å…¬å‘Šæ ‡é¢˜">
          <el-input 
            v-model="announcementForm.title"
            placeholder="è¾“å…¥å…¬å‘Šæ ‡é¢˜"
            maxlength="50"
            show-word-limit
          />
        </el-form-item>

        <el-form-item label="å…¬å‘Šå†…å®¹">
          <el-input 
            type="textarea" 
            v-model="announcementForm.content"
            placeholder="è¾“å…¥å…¬å‘Šè¯¦ç»†å†…å®¹"
            :rows="5"
            maxlength="1000"
            show-word-limit
          />
        </el-form-item>

        <el-form-item label="é…å›¾">
          <el-upload
            class="announcement-uploader"
            action="/api/upload/announcement-image"
            :show-file-list="false"
            :on-success="handleImageUpload"
          >
            <img v-if="announcementForm.image_url" :src="announcementForm.image_url" class="announcement-image" />
            <el-icon v-else class="announcement-uploader-icon"><Plus /></el-icon>
          </el-upload>
        </el-form-item>

        <el-form-item label="ç´§æ€¥ç¨‹åº¦">
          <el-radio-group v-model="announcementForm.urgency">
            <el-radio label="low">ğŸ“… æ™®é€š</el-radio>
            <el-radio label="medium">âš ï¸ é‡è¦</el-radio>
            <el-radio label="high">ğŸš¨ ç´§æ€¥</el-radio>
          </el-radio-group>
        </el-form-item>

        <el-form-item label="å‘é€ç­–ç•¥">
          <el-checkbox-group v-model="announcementForm.send_options">
            <el-checkbox label="immediate">ç«‹å³å‘é€</el-checkbox>
            <el-checkbox label="optimal_time">æ™ºèƒ½æ—¶é—´å‘é€</el-checkbox>
            <el-checkbox label="pin_message">ç½®é¡¶æ¶ˆæ¯</el-checkbox>
            <el-checkbox label="disable_preview">ç¦ç”¨é¢„è§ˆ</el-checkbox>
          </el-checkbox-group>
        </el-form-item>

        <el-form-item label="æ“ä½œæŒ‰é’®">
          <div class="action-buttons-config">
            <el-input 
              v-model="announcementForm.action_button.text"
              placeholder="æŒ‰é’®æ–‡å­—"
              style="width: 150px; margin-right: 10px;"
            />
            <el-select 
              v-model="announcementForm.action_button.type"
              placeholder="æŒ‰é’®ç±»å‹"
              style="width: 120px; margin-right: 10px;"
            >
              <el-option label="URLé“¾æ¥" value="url" />
              <el-option label="å›è°ƒåŠ¨ä½œ" value="callback" />
              <el-option label="æ— æŒ‰é’®" value="none" />
            </el-select>
            <el-input 
              v-model="announcementForm.action_button.value"
              placeholder="é“¾æ¥æˆ–å›è°ƒæ•°æ®"
              style="width: 200px;"
            />
          </div>
        </el-form-item>

        <el-form-item>
          <el-button 
            type="primary" 
            @click="sendAnnouncement"
            :loading="sendingAnnouncement"
          >
            ğŸ“¢ å‘é€å…¬å‘Š
          </el-button>
          
          <el-button 
            @click="previewAnnouncement"
          >
            ğŸ‘ï¸ é¢„è§ˆæ•ˆæœ
          </el-button>
        </el-form-item>

      </el-form>
    </el-card>

    <!-- å‘é€å†å²è®°å½• -->
    <el-card class="notification-history">
      <template #header>
        <span>ğŸ“Š å‘é€å†å²</span>
      </template>
      
      <el-table :data="notificationHistory" style="width: 100%">
        <el-table-column prop="type" label="é€šçŸ¥ç±»å‹" width="120" />
        <el-table-column prop="title" label="æ ‡é¢˜" width="200" />
        <el-table-column prop="target_count" label="ç›®æ ‡ç”¨æˆ·æ•°" width="100" />
        <el-table-column prop="sent_count" label="æˆåŠŸå‘é€" width="100" />
        <el-table-column prop="failed_count" label="å‘é€å¤±è´¥" width="100" />
        <el-table-column prop="created_at" label="å‘é€æ—¶é—´" width="160" />
        <el-table-column label="æ“ä½œ" width="200">
          <template #default="scope">
            <el-button 
              size="small" 
              @click="viewDetails(scope.row)"
            >
              æŸ¥çœ‹è¯¦æƒ…
            </el-button>
            <el-button 
              size="small" 
              type="warning"
              @click="resendNotification(scope.row)"
            >
              é‡æ–°å‘é€
            </el-button>
          </template>
        </el-table-column>
      </el-table>

    </el-card>

  </div>
</template>
```

### æ¶ˆæ¯æ¨¡æ¿ç®¡ç†

```vue
<template>
  <div class="message-template-panel">
    
    <!-- æ¨¡æ¿åˆ—è¡¨ -->
    <div class="template-list">
      <el-card>
        <template #header>
          <div class="template-header">
            <span>ğŸ“ æ¶ˆæ¯æ¨¡æ¿åº“</span>
            <el-button 
              type="primary" 
              size="small"
              @click="showCreateTemplate = true"
            >
              â• æ–°å»ºæ¨¡æ¿
            </el-button>
          </div>
        </template>

        <el-table :data="templates" style="width: 100%">
          
          <el-table-column prop="name" label="æ¨¡æ¿åç§°" width="200" />
          
          <el-table-column prop="type" label="é€šçŸ¥ç±»å‹" width="150">
            <template #default="scope">
              <el-tag :type="getTypeColor(scope.row.type)">
                {{ getTypeName(scope.row.type) }}
              </el-tag>
            </template>
          </el-table-column>
          
          <el-table-column prop="language" label="è¯­è¨€" width="100" />
          
          <el-table-column label="æ¨¡æ¿é¢„è§ˆ" width="300">
            <template #default="scope">
              <div class="template-preview">
                {{ truncateText(scope.row.content, 100) }}
              </div>
            </template>
          </el-table-column>
          
          <el-table-column prop="usage_count" label="ä½¿ç”¨æ¬¡æ•°" width="100" />
          
          <el-table-column prop="updated_at" label="æ›´æ–°æ—¶é—´" width="160" />
          
          <el-table-column label="æ“ä½œ" width="250">
            <template #default="scope">
              <el-button 
                size="small" 
                @click="editTemplate(scope.row)"
              >
                âœï¸ ç¼–è¾‘
              </el-button>
              <el-button 
                size="small" 
                type="success"
                @click="testTemplate(scope.row)"
              >
                ğŸ§ª æµ‹è¯•
              </el-button>
              <el-button 
                size="small" 
                type="info"
                @click="duplicateTemplate(scope.row)"
              >
                ğŸ“„ å¤åˆ¶
              </el-button>
              <el-button 
                size="small" 
                type="danger"
                @click="deleteTemplate(scope.row)"
              >
                ğŸ—‘ï¸ åˆ é™¤
              </el-button>
            </template>
          </el-table-column>
          
        </el-table>
      </el-card>
    </div>

    <!-- æ¨¡æ¿ç¼–è¾‘å™¨ -->
    <el-dialog 
      v-model="showTemplateEditor" 
      title="ç¼–è¾‘æ¶ˆæ¯æ¨¡æ¿"
      width="80%"
      :before-close="handleEditorClose"
    >
      <div class="template-editor">
        
        <!-- åŸºç¡€ä¿¡æ¯ -->
        <el-form :model="currentTemplate" label-width="120px">
          
          <el-row :gutter="20">
            <el-col :span="12">
              <el-form-item label="æ¨¡æ¿åç§°" required>
                <el-input v-model="currentTemplate.name" placeholder="è¾“å…¥æ¨¡æ¿åç§°" />
              </el-form-item>
            </el-col>
            <el-col :span="12">
              <el-form-item label="é€šçŸ¥ç±»å‹" required>
                <el-select v-model="currentTemplate.type" placeholder="é€‰æ‹©é€šçŸ¥ç±»å‹">
                  <el-option 
                    v-for="type in notificationTypes" 
                    :key="type.value"
                    :label="type.label" 
                    :value="type.value" 
                  />
                </el-select>
              </el-form-item>
            </el-col>
          </el-row>

          <el-row :gutter="20">
            <el-col :span="12">
              <el-form-item label="è¯­è¨€">
                <el-select v-model="currentTemplate.language" placeholder="é€‰æ‹©è¯­è¨€">
                  <el-option label="ä¸­æ–‡" value="zh" />
                  <el-option label="English" value="en" />
                  <el-option label="æ—¥æœ¬èª" value="ja" />
                </el-select>
              </el-form-item>
            </el-col>
            <el-col :span="12">
              <el-form-item label="æ¶ˆæ¯æ ¼å¼">
                <el-select v-model="currentTemplate.parse_mode" placeholder="é€‰æ‹©æ ¼å¼">
                  <el-option label="Markdown" value="Markdown" />
                  <el-option label="HTML" value="HTML" />
                  <el-option label="çº¯æ–‡æœ¬" value="text" />
                </el-select>
              </el-form-item>
            </el-col>
          </el-row>

        </el-form>

        <!-- å†…å®¹ç¼–è¾‘åŒºåŸŸ -->
        <div class="content-editor">
          <el-row :gutter="20">
            
            <!-- æ¨¡æ¿å†…å®¹ -->
            <el-col :span="12">
              <div class="editor-section">
                <h4>ğŸ“ æ¶ˆæ¯å†…å®¹</h4>
                <el-input
                  type="textarea"
                  v-model="currentTemplate.content"
                  placeholder="è¾“å…¥æ¶ˆæ¯æ¨¡æ¿å†…å®¹ï¼Œä½¿ç”¨ {{å˜é‡å}} æ¥è¡¨ç¤ºåŠ¨æ€å†…å®¹"
                  :rows="15"
                  class="template-textarea"
                />
                
                <!-- å˜é‡åŠ©æ‰‹ -->
                <div class="variable-helper">
                  <h5>ğŸ’¡ å¯ç”¨å˜é‡</h5>
                  <div class="variable-tags">
                    <el-tag 
                      v-for="variable in availableVariables" 
                      :key="variable.name"
                      @click="insertVariable(variable.name)"
                      class="variable-tag"
                    >
                      {{`{{${variable.name}}}`}}
                    </el-tag>
                  </div>
                </div>
              </div>
            </el-col>
            
            <!-- å®æ—¶é¢„è§ˆ -->
            <el-col :span="12">
              <div class="preview-section">
                <h4>ğŸ‘ï¸ å®æ—¶é¢„è§ˆ</h4>
                <div class="telegram-preview">
                  <div class="telegram-message">
                    <div v-html="renderPreview()" class="message-content"></div>
                    
                    <!-- æŒ‰é’®é¢„è§ˆ -->
                    <div v-if="currentTemplate.buttons && currentTemplate.buttons.length > 0" class="buttons-preview">
                      <div 
                        v-for="(button, index) in currentTemplate.buttons" 
                        :key="index"
                        class="telegram-button"
                      >
                        {{ button.text }}
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- æµ‹è¯•æ•°æ® -->
                <div class="test-data">
                  <h5>ğŸ§ª æµ‹è¯•æ•°æ®</h5>
                  <el-input
                    type="textarea"
                    v-model="testDataJson"
                    placeholder="è¾“å…¥JSONæ ¼å¼çš„æµ‹è¯•æ•°æ®"
                    :rows="5"
                    @input="updatePreview"
                  />
                </div>
              </div>
            </el-col>
            
          </el-row>
        </div>

        <!-- æŒ‰é’®é…ç½® -->
        <div class="buttons-config">
          <h4>ğŸ”˜ å†…è”æŒ‰é’®é…ç½®</h4>
          <div 
            v-for="(button, index) in currentTemplate.buttons" 
            :key="index"
            class="button-config-item"
          >
            <el-row :gutter="10">
              <el-col :span="6">
                <el-input v-model="button.text" placeholder="æŒ‰é’®æ–‡å­—" />
              </el-col>
              <el-col :span="4">
                <el-select v-model="button.type" placeholder="ç±»å‹">
                  <el-option label="å›è°ƒ" value="callback_data" />
                  <el-option label="é“¾æ¥" value="url" />
                </el-select>
              </el-col>
              <el-col :span="8">
                <el-input v-model="button.value" placeholder="å›è°ƒæ•°æ®æˆ–URL" />
              </el-col>
              <el-col :span="4">
                <el-button 
                  type="danger" 
                  size="small"
                  @click="removeButton(index)"
                >
                  åˆ é™¤
                </el-button>
              </el-col>
            </el-row>
          </div>
          
          <el-button 
            type="primary" 
            size="small"
            @click="addButton"
          >
            â• æ·»åŠ æŒ‰é’®
          </el-button>
        </div>

      </div>

      <template #footer>
        <el-button @click="showTemplateEditor = false">å–æ¶ˆ</el-button>
        <el-button type="primary" @click="saveTemplate">ä¿å­˜æ¨¡æ¿</el-button>
        <el-button type="success" @click="testCurrentTemplate">å‘é€æµ‹è¯•</el-button>
      </template>

    </el-dialog>

  </div>
</template>
```

## ğŸ› ï¸ æ•°æ®åº“æ‰©å±•è®¾è®¡

### é€šçŸ¥é…ç½®è¡¨

```sql
-- æœºå™¨äººé€šçŸ¥é…ç½®è¡¨
CREATE TABLE telegram_bot_notification_configs (
    id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
    bot_id UUID NOT NULL REFERENCES telegram_bots(id) ON DELETE CASCADE,
    
    -- æ€»ä½“é…ç½®
    enabled BOOLEAN DEFAULT true,
    default_language VARCHAR(10) DEFAULT 'zh',
    timezone VARCHAR(50) DEFAULT 'Asia/Shanghai',
    
    -- åˆ†ç±»é…ç½® (JSON)
    business_notifications JSONB DEFAULT '{}',
    agent_notifications JSONB DEFAULT '{}',
    price_notifications JSONB DEFAULT '{}',
    system_notifications JSONB DEFAULT '{}',
    marketing_notifications JSONB DEFAULT '{}',
    
    -- å‘é€ç­–ç•¥
    rate_limiting JSONB DEFAULT '{}',
    retry_strategy JSONB DEFAULT '{}',
    quiet_hours JSONB DEFAULT '{}',
    
    -- ç»Ÿè®¡å¼€å…³
    analytics_enabled BOOLEAN DEFAULT true,
    performance_monitoring BOOLEAN DEFAULT true,
    
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- æ¶ˆæ¯æ¨¡æ¿è¡¨
CREATE TABLE telegram_message_templates (
    id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
    bot_id UUID NOT NULL REFERENCES telegram_bots(id) ON DELETE CASCADE,
    
    name VARCHAR(200) NOT NULL,
    type VARCHAR(100) NOT NULL, -- é€šçŸ¥ç±»å‹
    language VARCHAR(10) DEFAULT 'zh',
    
    -- æ¨¡æ¿å†…å®¹
    content TEXT NOT NULL,
    parse_mode VARCHAR(20) DEFAULT 'Markdown',
    
    -- æŒ‰é’®é…ç½®
    buttons JSONB DEFAULT '[]',
    
    -- å˜é‡å®šä¹‰
    variables JSONB DEFAULT '[]',
    
    -- ä½¿ç”¨ç»Ÿè®¡
    usage_count INTEGER DEFAULT 0,
    last_used_at TIMESTAMP WITH TIME ZONE,
    
    -- çŠ¶æ€
    is_active BOOLEAN DEFAULT true,
    is_default BOOLEAN DEFAULT false,
    
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    created_by UUID NOT NULL
);

-- é€šçŸ¥å‘é€è®°å½•è¡¨
CREATE TABLE telegram_notification_logs (
    id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
    bot_id UUID NOT NULL REFERENCES telegram_bots(id) ON DELETE CASCADE,
    
    -- é€šçŸ¥åŸºæœ¬ä¿¡æ¯
    notification_type VARCHAR(100) NOT NULL,
    title VARCHAR(500),
    
    -- å‘é€ç›®æ ‡
    target_type VARCHAR(50) NOT NULL, -- 'all', 'user', 'group', 'agents'
    target_count INTEGER DEFAULT 0,
    
    -- å‘é€ç»“æœ
    sent_count INTEGER DEFAULT 0,
    failed_count INTEGER DEFAULT 0,
    status VARCHAR(50) DEFAULT 'pending', -- 'pending', 'sending', 'completed', 'failed'
    
    -- å‘é€å†…å®¹
    message_content TEXT,
    template_id UUID REFERENCES telegram_message_templates(id),
    
    -- å‘é€é…ç½®
    send_immediately BOOLEAN DEFAULT true,
    scheduled_at TIMESTAMP WITH TIME ZONE,
    
    -- å…ƒæ•°æ®
    metadata JSONB DEFAULT '{}',
    error_details TEXT,
    
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    completed_at TIMESTAMP WITH TIME ZONE,
    created_by UUID NOT NULL
);

-- ç”¨æˆ·é€šçŸ¥åå¥½è¡¨
CREATE TABLE user_notification_preferences (
    id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    bot_id UUID NOT NULL REFERENCES telegram_bots(id) ON DELETE CASCADE,
    
    -- é€šçŸ¥å¼€å…³
    enabled_types JSONB DEFAULT '[]', -- å…è®¸çš„é€šçŸ¥ç±»å‹æ•°ç»„
    disabled_types JSONB DEFAULT '[]', -- ç¦ç”¨çš„é€šçŸ¥ç±»å‹æ•°ç»„
    
    -- æ—¶é—´è®¾ç½®
    quiet_hours JSONB DEFAULT '{}', -- é™é»˜æ—¶é—´æ®µé…ç½®
    timezone VARCHAR(50) DEFAULT 'Asia/Shanghai',
    
    -- æ¥æ”¶åå¥½
    prefer_images BOOLEAN DEFAULT true,
    language VARCHAR(10) DEFAULT 'zh',
    
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    
    UNIQUE(user_id, bot_id)
);

-- é€šçŸ¥ç»Ÿè®¡è¡¨
CREATE TABLE telegram_notification_analytics (
    id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
    bot_id UUID NOT NULL REFERENCES telegram_bots(id) ON DELETE CASCADE,
    
    date DATE NOT NULL,
    notification_type VARCHAR(100) NOT NULL,
    
    -- å‘é€ç»Ÿè®¡
    total_sent INTEGER DEFAULT 0,
    total_failed INTEGER DEFAULT 0,
    
    -- ç”¨æˆ·äº¤äº’ç»Ÿè®¡
    opened_count INTEGER DEFAULT 0,
    clicked_count INTEGER DEFAULT 0,
    
    -- æ€§èƒ½ç»Ÿè®¡
    avg_send_time_ms INTEGER DEFAULT 0,
    max_send_time_ms INTEGER DEFAULT 0,
    
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    
    UNIQUE(bot_id, date, notification_type)
);
```

## ğŸš€ åç«¯APIæ¥å£è®¾è®¡

### é€šçŸ¥é…ç½®API

```typescript
// é€šçŸ¥é…ç½®ç®¡ç†API
export class NotificationConfigAPI {
  
  // è·å–æœºå™¨äººé€šçŸ¥é…ç½®
  async getBotNotificationConfig(botId: string): Promise<BotNotificationConfig> {
    const result = await query(
      'SELECT * FROM telegram_bot_notification_configs WHERE bot_id = $1',
      [botId]
    );
    
    if (result.rows.length === 0) {
      // åˆ›å»ºé»˜è®¤é…ç½®
      return await this.createDefaultConfig(botId);
    }
    
    return this.parseConfig(result.rows[0]);
  }
  
  // æ›´æ–°é€šçŸ¥é…ç½®
  async updateNotificationConfig(
    botId: string, 
    config: Partial<BotNotificationConfig>
  ): Promise<void> {
    await query(`
      UPDATE telegram_bot_notification_configs 
      SET 
        enabled = $2,
        business_notifications = $3,
        agent_notifications = $4,
        price_notifications = $5,
        system_notifications = $6,
        marketing_notifications = $7,
        updated_at = CURRENT_TIMESTAMP
      WHERE bot_id = $1
    `, [
      botId,
      config.enabled,
      JSON.stringify(config.business_notifications),
      JSON.stringify(config.agent_notifications),
      JSON.stringify(config.price_notifications),
      JSON.stringify(config.system_notifications),
      JSON.stringify(config.marketing_notifications)
    ]);
  }
}

// æ‰‹åŠ¨é€šçŸ¥å‘é€API
export class ManualNotificationAPI {
  
  // å‘é€ç³»ç»Ÿç»´æŠ¤é€šçŸ¥
  async sendMaintenanceNotification(
    botId: string,
    maintenanceInfo: MaintenanceNotificationData,
    createdBy: string
  ): Promise<string> {
    
    // åˆ›å»ºé€šçŸ¥è®°å½•
    const notificationId = await this.createNotificationRecord(
      botId,
      'system_maintenance',
      maintenanceInfo,
      createdBy
    );
    
    // è·å–ç›®æ ‡ç”¨æˆ·
    const targetUsers = await this.getTargetUsers(botId, maintenanceInfo.target_users);
    
    // ç”Ÿæˆæ¶ˆæ¯å†…å®¹
    const messageContent = await this.renderMaintenanceMessage(maintenanceInfo);
    
    // å‘é€é€šçŸ¥
    await this.sendToUsers(botId, targetUsers, messageContent, notificationId);
    
    return notificationId;
  }
  
  // å‘é€é‡è¦å…¬å‘Š
  async sendAnnouncement(
    botId: string,
    announcement: AnnouncementData,
    createdBy: string
  ): Promise<string> {
    
    const notificationId = await this.createNotificationRecord(
      botId,
      'important_announcement',
      announcement,
      createdBy
    );
    
    // æ ¹æ®ç´§æ€¥ç¨‹åº¦å†³å®šå‘é€ç­–ç•¥
    if (announcement.urgency === 'high') {
      await this.sendImmediately(botId, announcement, notificationId);
    } else {
      await this.scheduleOptimalSend(botId, announcement, notificationId);
    }
    
    return notificationId;
  }
  
  // æ‰¹é‡å‘é€é€šçŸ¥
  private async sendToUsers(
    botId: string,
    users: User[],
    messageContent: MessageContent,
    notificationId: string
  ): Promise<void> {
    
    const batchSize = 30;
    let sentCount = 0;
    let failedCount = 0;
    
    for (let i = 0; i < users.length; i += batchSize) {
      const batch = users.slice(i, i + batchSize);
      
      const results = await Promise.allSettled(
        batch.map(user => this.sendSingleNotification(botId, user, messageContent))
      );
      
      results.forEach(result => {
        if (result.status === 'fulfilled') {
          sentCount++;
        } else {
          failedCount++;
          console.error('å‘é€å¤±è´¥:', result.reason);
        }
      });
      
      // æ›´æ–°å‘é€è¿›åº¦
      await this.updateNotificationProgress(notificationId, sentCount, failedCount);
      
      // æ‰¹æ¬¡é—´å»¶è¿Ÿ
      if (i + batchSize < users.length) {
        await this.delay(1100);
      }
    }
    
    // æ ‡è®°å®Œæˆ
    await this.markNotificationCompleted(notificationId, sentCount, failedCount);
  }
}
```

## ğŸ“Š å‰ç«¯å®ç°è¦ç‚¹

### 1. ç»„ä»¶ç»“æ„

```
src/components/BotManagement/NotificationConfig/
â”œâ”€â”€ index.vue                    # ä¸»å…¥å£ç»„ä»¶
â”œâ”€â”€ BusinessNotificationPanel.vue    # ä¸šåŠ¡é€šçŸ¥é…ç½®
â”œâ”€â”€ AgentNotificationPanel.vue       # ä»£ç†é€šçŸ¥é…ç½®
â”œâ”€â”€ PriceNotificationPanel.vue       # ä»·æ ¼é€šçŸ¥é…ç½®
â”œâ”€â”€ SystemNotificationPanel.vue      # ç³»ç»Ÿé€šçŸ¥é…ç½®
â”œâ”€â”€ MarketingNotificationPanel.vue   # è¥é”€é€šçŸ¥é…ç½®
â”œâ”€â”€ MessageTemplatePanel.vue         # æ¶ˆæ¯æ¨¡æ¿ç®¡ç†
â”œâ”€â”€ NotificationSettingsPanel.vue    # å‘é€è®¾ç½®
â”œâ”€â”€ NotificationAnalyticsPanel.vue   # ç»Ÿè®¡ç›‘æ§
â”œâ”€â”€ ManualNotificationDialog.vue     # æ‰‹åŠ¨å‘é€å¯¹è¯æ¡†
â””â”€â”€ components/
    â”œâ”€â”€ TemplateEditor.vue           # æ¨¡æ¿ç¼–è¾‘å™¨
    â”œâ”€â”€ NotificationPreview.vue      # é€šçŸ¥é¢„è§ˆ
    â””â”€â”€ SendingProgressDialog.vue    # å‘é€è¿›åº¦å¯¹è¯æ¡†
```

### 2. çŠ¶æ€ç®¡ç†

```typescript
// stores/notificationConfig.ts
export const useNotificationConfigStore = defineStore('notificationConfig', {
  state: () => ({
    currentBotId: '',
    config: {} as BotNotificationConfig,
    templates: [] as MessageTemplate[],
    sendingHistory: [] as NotificationLog[],
    analytics: {} as NotificationAnalytics,
    loading: false,
    saving: false
  }),
  
  actions: {
    async loadConfig(botId: string) {
      this.loading = true;
      try {
        this.config = await notificationAPI.getBotConfig(botId);
        this.templates = await notificationAPI.getTemplates(botId);
        this.currentBotId = botId;
      } finally {
        this.loading = false;
      }
    },
    
    async saveConfig() {
      this.saving = true;
      try {
        await notificationAPI.updateConfig(this.currentBotId, this.config);
        ElMessage.success('é…ç½®ä¿å­˜æˆåŠŸ');
      } finally {
        this.saving = false;
      }
    },
    
    async sendManualNotification(notificationData: any) {
      return await notificationAPI.sendManual(this.currentBotId, notificationData);
    }
  }
});
```

### 3. å®æ—¶é€šçŸ¥çŠ¶æ€æ›´æ–°

```typescript
// composables/useNotificationStatus.ts
export function useNotificationStatus(notificationId: string) {
  const status = ref('pending');
  const progress = ref(0);
  const details = ref({});
  
  // WebSocketè¿æ¥è·å–å®æ—¶çŠ¶æ€
  const ws = new WebSocket(`ws://localhost:3001/notification-status/${notificationId}`);
  
  ws.onmessage = (event) => {
    const data = JSON.parse(event.data);
    status.value = data.status;
    progress.value = data.progress;
    details.value = data.details;
  };
  
  onUnmounted(() => {
    ws.close();
  });
  
  return { status, progress, details };
}
```

## ğŸ¯ å®æ–½ä¼˜å…ˆçº§å’Œæ—¶é—´è§„åˆ’

### Phase 1: åŸºç¡€é€šçŸ¥é…ç½®ï¼ˆ1-2å‘¨ï¼‰
1. âœ… æ•°æ®åº“è¡¨è®¾è®¡å’Œåˆ›å»º
2. âœ… åŸºç¡€é€šçŸ¥é…ç½®API
3. âœ… æœºå™¨äººå¡ç‰‡é€šçŸ¥ç®¡ç†æ ‡ç­¾é¡µ
4. âœ… ä¸šåŠ¡é€šçŸ¥é…ç½®é¢æ¿

### Phase 2: æ¨¡æ¿å’Œæ‰‹åŠ¨é€šçŸ¥ï¼ˆ2-3å‘¨ï¼‰
1. ğŸ”„ æ¶ˆæ¯æ¨¡æ¿ç®¡ç†ç³»ç»Ÿ
2. ğŸ”„ ç³»ç»Ÿç»´æŠ¤é€šçŸ¥åŠŸèƒ½
3. ğŸ”„ é‡è¦å…¬å‘Šå‘é€åŠŸèƒ½
4. ğŸ”„ å‘é€è¿›åº¦å®æ—¶ç›‘æ§

### Phase 3: é«˜çº§åŠŸèƒ½ï¼ˆ3-4å‘¨ï¼‰
1. ğŸ“Š é€šçŸ¥æ•ˆæœç»Ÿè®¡åˆ†æ
2. ğŸ¯ ä¸ªæ€§åŒ–é€šçŸ¥è®¾ç½®
3. ğŸ” A/Bæµ‹è¯•æ¡†æ¶
4. ğŸ“± ç§»åŠ¨ç«¯é€‚é…ä¼˜åŒ–

è¿™ä¸ªè®¾è®¡æ–¹æ¡ˆå®Œå…¨åŸºäºæ‚¨çš„TRONèƒ½é‡ç§Ÿèµé¡¹ç›®ç‰¹ç‚¹ï¼Œæä¾›äº†å®Œæ•´çš„é€šçŸ¥ç®¡ç†åŠŸèƒ½ï¼Œè®©ç®¡ç†å‘˜å¯ä»¥çµæ´»é…ç½®å’Œå‘é€å„ç§ç±»å‹çš„é€šçŸ¥ã€‚
