<template>
  <div class="flex gap-2">
    <div class="w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
      <span class="text-white text-xs">ðŸ¤–</span>
    </div>
    <div class="flex-1">
      <div class="bg-gray-100 rounded-lg p-3 max-w-xs">
        <!-- å›¾ç‰‡æ˜¾ç¤ºï¼ˆå¦‚æžœå¯ç”¨ï¼‰ -->
        <div v-if="imageEnabled && imageUrl" class="mb-3">
          <img 
            :src="imageUrl" 
            :alt="imageAlt || 'ç¬”æ•°å¥—é¤é…ç½®å›¾ç‰‡'" 
            class="w-full rounded-lg border"
            @error="handleImageError"
          />
          <div v-if="imageAlt" class="text-xs text-gray-500 mt-1 text-center">
            {{ imageAlt }}
          </div>
        </div>
        
        <!-- ä¸»æ¶ˆæ¯å†…å®¹ -->
        <div class="text-xs whitespace-pre-line">
          {{ messageContent }}
        </div>
      </div>
      
      <!-- å†…åµŒé”®ç›˜ï¼ˆæ˜¾ç¤ºåœ¨æ¶ˆæ¯ä¸‹æ–¹ï¼‰ -->
      <slot name="keyboard"></slot>
      
      <div class="text-xs text-gray-400 mt-1">{{ currentTime }}</div>
    </div>
  </div>
</template>

<script setup lang="ts">
interface Props {
  messageContent: string
  currentTime: string
  imageEnabled: boolean
  imageUrl: string
  imageAlt: string
}

defineProps<Props>()

// å›¾ç‰‡åŠ è½½é”™è¯¯å¤„ç†
const handleImageError = (event: Event) => {
  const img = event.target as HTMLImageElement
  console.error('å›¾ç‰‡åŠ è½½å¤±è´¥:', img.src)
}
</script>
